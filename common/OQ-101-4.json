{
  "title": "Auto-Termination Validation",
  "test_description": "Check auto-termination setting - Auto-termination configured with autotermination_minutes ≤ 120 and > 0",
  "version": "1.0",
  "test_code": "OQ-101-4",
  "test_seq": 4,
  "test_suite": "OQ-101",
  "test_suite_title": "Cluster Availability",
  "category": "OQ",
  "manual_procedure": "Check the cluster's auto-termination setting via the UI or API. Confirm that auto-termination is set to 120 minutes or less (or as configured).",
  "api_calls": [
    {
      "step": 1,
      "name": "get_cluster_info",
      "method": "GET",
      "api_url": "${workspace_url}/api/2.0/clusters/get",
      "headers": {
        "Authorization": "Bearer ${token}",
        "Content-Type": "application/json"
      },
      "payload": {
        "cluster_id": "${cluster_id}"
      },
      "post_processing": "function processStep(responseData, currentVariables) { const autoTermMinutes = responseData.autotermination_minutes || 0; const clusterName = responseData.cluster_name || 'Unknown'; logger.debug('Cluster auto-termination:', { autoTermMinutes, clusterName }); return { ...currentVariables, auto_termination_minutes: autoTermMinutes, cluster_name: clusterName }; }"
    }
  ],
  "response_schema": null,
  "parser_code": "function aggregateResults(stepResults) { const clusterStep = stepResults.get_cluster_info; if (clusterStep.error) { return { status: 'fail', message: 'No response received from API', code: 'NO_RESPONSE', test_id: 'OQ-101-4', title: 'Auto-Termination Validation', expected_result: 'Auto-termination: ≤120 min.', actual_result: 'No cluster information.' }; } const apiOutput = clusterStep.data; try { const maxAutoTermination = variables.oq_101_4_max_auto_termination !== undefined ? variables.oq_101_4_max_auto_termination : 120; const minAutoTermination = variables.oq_101_4_min_auto_termination !== undefined ? variables.oq_101_4_min_auto_termination : 0; const expected_result = `Auto-termination: ≤${maxAutoTermination} min.`; const autoTermMinutes = apiOutput.autotermination_minutes || 0; const actual_result = `Auto-termination: ${autoTermMinutes} min`; if (autoTermMinutes <= maxAutoTermination && autoTermMinutes > minAutoTermination) { return { status: 'pass', message: `Auto-termination is set to ${autoTermMinutes} minutes, within the required range.`, code: 'VALID_AUTO_TERMINATION', test_id: 'OQ-101-4', title: 'Auto-Termination Validation', expected_result, actual_result }; } else { return { status: 'fail', message: `Auto-termination is set to ${autoTermMinutes} minutes, which is outside the required range (${minAutoTermination}-${maxAutoTermination}).`, code: 'INVALID_AUTO_TERMINATION', test_id: 'OQ-101-4', title: 'Auto-Termination Validation', expected_result, actual_result }; } } catch (error) { return { status: 'fail', message: 'Error processing auto-termination data: ' + error.message, code: 'PROCESSING_ERROR', test_id: 'OQ-101-4', title: 'Auto-Termination Validation', expected_result: 'Auto-termination: ≤120 min.', actual_result: 'Error processing data.' }; } }"
} 